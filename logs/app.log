2025-12-16 08:53:12.214 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 46768 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 08:53:12.221 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 08:53:12.774 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 08:53:12.807 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 29 ms. Found 2 JPA repository interfaces.
2025-12-16 08:53:13.760 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 08:53:13.768 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 08:53:13.769 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 08:53:13.810 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 08:53:13.810 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1571 ms
2025-12-16 08:53:14.215 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 08:53:14.341 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 08:53:14.366 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 08:53:14.530 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 08:53:14.558 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 08:53:14.830 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2b540131
2025-12-16 08:53:14.832 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 08:53:14.941 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 08:53:15.492 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 08:53:15.755 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 08:53:16.289 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 08:53:16.809 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 08:53:16.844 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 08:53:16.855 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 4.928 seconds (process running for 5.864)
2025-12-16 08:57:23.734 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-16 08:57:23.734 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-16 08:57:23.737 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-12-16 08:57:23.785 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 08:57:24.220 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160170234051168], success=true, failed=false)
2025-12-16 08:57:24.232 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160170234051168,"x":100,"y":100}],"taskDefinitionJson":[{"code":160170234051168,"version":0,"name":"HIVECLI1765846644221","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160170234051168,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 08:57:24.576 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160170234154592/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:10:59.524 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:10:59.530 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 09:10:59.540 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 09:11:05.780 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 48302 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 09:11:05.781 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 09:11:06.170 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 09:11:06.196 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 2 JPA repository interfaces.
2025-12-16 09:11:06.472 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 09:11:06.478 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 09:11:06.478 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 09:11:06.497 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 09:11:06.497 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 698 ms
2025-12-16 09:11:06.649 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 09:11:06.681 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 09:11:06.710 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 09:11:06.809 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 09:11:06.818 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 09:11:06.902 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@16d4024e
2025-12-16 09:11:06.904 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 09:11:06.949 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 09:11:07.242 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 09:11:07.280 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:11:07.563 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 09:11:07.775 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 09:11:07.802 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 09:11:07.812 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.515 seconds (process running for 2.722)
2025-12-16 09:11:28.903 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-16 09:11:28.905 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-16 09:11:28.908 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-16 09:11:28.949 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 09:11:29.165 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160171099279968], success=true, failed=false)
2025-12-16 09:11:29.175 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160171099279968,"x":100,"y":100}],"taskDefinitionJson":[{"code":160171099279968,"version":0,"name":"HIVECLI1765847489166","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160171099279968,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 09:11:29.245 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160171099341408/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:26:22.351 WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=45s189ms).
2025-12-16 09:36:12.773 WARN  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=9m50s425ms).
2025-12-16 09:38:13.186 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 09:38:13.325 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160172741966432], success=true, failed=false)
2025-12-16 09:38:13.327 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160172741966432,"x":100,"y":100}],"taskDefinitionJson":[{"code":160172741966432,"version":0,"name":"HIVECLI1765849093326","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160172741966432,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 09:38:13.389 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160172742003296/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:38:25.530 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:38:25.532 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 09:38:25.542 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 09:38:36.775 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 49942 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 09:38:36.777 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 09:38:37.148 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 09:38:37.167 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 2 JPA repository interfaces.
2025-12-16 09:38:37.422 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 09:38:37.427 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 09:38:37.427 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 09:38:37.444 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 09:38:37.445 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 643 ms
2025-12-16 09:38:37.550 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 09:38:37.572 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 09:38:37.582 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 09:38:37.657 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 09:38:37.667 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 09:38:37.729 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@224d537d
2025-12-16 09:38:37.729 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 09:38:37.757 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 09:38:38.079 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 09:38:38.104 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:38:38.371 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 09:38:38.572 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 09:38:38.605 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 09:38:38.615 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.352 seconds (process running for 2.969)
2025-12-16 09:39:34.747 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-16 09:39:34.748 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-16 09:39:34.758 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 10 ms
2025-12-16 09:39:34.795 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 09:39:35.014 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160172825598560], success=true, failed=false)
2025-12-16 09:39:35.024 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160172825598560,"x":100,"y":100}],"taskDefinitionJson":[{"code":160172825598560,"version":0,"name":"HIVECLI1765849175015","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160172825598560,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 09:39:35.104 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160172825665120/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:44:12.126 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160172825665120/release, param:WorkflowReleaseParam(name=null, releaseState=OFFLINE)
2025-12-16 09:44:12.225 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 09:44:12.237 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160173109493344], success=true, failed=false)
2025-12-16 09:44:12.238 INFO  c.x.s.d.workflow.WorkflowOperator - update workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160172825665120, param:WorkflowDefineParam(name=dim_gzg_pub_ip_location_info, locations=[{"taskCode":160173109493344,"x":100,"y":100}], taskDefinitionJson=[{"code":160173109493344,"version":0,"name":"HIVECLI1765849452238","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"-- 股掌柜APP-行为数据 对应实时表cdm.dwd_gzg_log_app_behavior_rt\n-- test \ninsert overwrite table cdm.dwd_gzg_log_app_behavior_di PARTITION (dt)\nselect case when p1.account_id rlike '^TS' then '0' else p1.user_id end    as user_id\n     , p1.user_number                                                      as user_number\n     , p1.guid                                                             as guid\n     , p1.`application`                                                      as `application`\n     , p1.version                                                          as version\n     , p1.platform                                                         as platform\n     , p1.page_id                                                          as start_object\n     , p1.object                                                           as objects\n     , from_unixtime(cast(p1.createtime as bigint), 'yyyy-MM-dd HH:mm:ss') as create_time\n     , p1.action_type                                                      as action_type\n     , p1.is_fanhui                                                        as is_return\n     , p1.scode_id                                                         as scode_id\n     , p1.market_id                                                        as market_id\n     , p1.screen_direction                                                 as screen_direction\n     , p1.color                                                            as bgcolor\n     , p1.frameid                                                          as frame_id\n     , p1.type                                                             as log_type\n     , p1.qs_id                                                            as qs_id\n     , p1.from_frameid                                                     as from_frame_id\n     , p1.from_object                                                      as from_object\n     , p1.from_resourceid                                                  as from_resource_id\n     , p1.to_frameid                                                       as to_frame_id\n     , p1.to_resourceid                                                    as to_resource_id\n     , p1.to_scode                                                         as to_scode\n     , p1.account_id                                                       as account_id\n     , p1.event_type                                                       as event_type\n     , p1.target_id                                                        as target_id\n     , p1.user_id                                                          as visitor_id\n     , case when p1.account_id rlike '^TS' then 1 else 0 end               as is_tourist\n     , from_unixtime(cast(p1.opentime as bigint), 'yyyy-MM-dd HH:mm:ss')   as open_time\n     , p1.tenant_id                                                        as tenant_id\n     , p1.p_date                                                           as dt\nfrom (select case when p1.user_id = '' then '0' else p1.user_id end                                  as user_id\n           , case\n                 when p1.user_id = '0' then null\n                 when p1.user_id = '' then null\n                 when p1.user_id < 1000101 then concat('GZ', substr(p1.user_id, 1, 1), substr(p1.user_number, 2, 1),\n                                                       substr(p1.user_id, 3, 1), substr(p1.user_number, 4, 1),\n                                                       substr(p1.user_id, 5, 1), substr(p1.user_number, 6, 1),\n                                                       substr(p1.user_id, 7, 1), substr(p1.user_number, 8, 1),\n                                                       substr(p1.user_id, 9, 1), substr(p1.user_number, 10, 1))\n                 else concat('AZ', substr(p1.user_id, 1, 1), substr(p1.user_number, 2, 1), substr(p1.user_id, 3, 1),\n                             substr(p1.user_number, 4, 1), substr(p1.user_id, 5, 1), substr(p1.user_number, 6, 1),\n                             substr(p1.user_id, 7, 1), substr(p1.user_number, 8, 1), substr(p1.user_id, 9, 1),\n                             substr(p1.user_number, 10, 1))\n        end                                                                                          as user_number\n           , case when p1.guid = '' then null else p1.guid end                                       as guid\n           , case when p1.`application` = '' then null else p1.`application` end                         as `application`\n           , case when p1.version = '' then null else p1.version end                                 as version\n           , case when p1.platform = '' then null else p1.platform end                               as platform\n           , case when split(p1.object, '\\\\.')[0] = '' then null else split(p1.object, '\\\\.')[0] end as page_id\n           , case when p1.object = '' then null else p1.object end                                   as object\n           , case when p1.createtime rlike '^[0-9]+$' then substr(p1.createtime, 1, 10) end          as createtime\n           , case when p1.action_type = '' then null else p1.action_type end                         as action_type\n           , case when p1.is_fanhui = '' then null else p1.is_fanhui end                             as is_fanhui\n           , case when p1.scode_id = '' then null else p1.scode_id end                               as scode_id\n           , case when p1.market_id = '' then null else p1.market_id end                             as market_id\n           , case when p1.screen_direction = '' then null else p1.screen_direction end               as screen_direction\n           , case when p1.color = '' then null else p1.color end                                     as color\n           , case when p1.frameid = '' then null else p1.frameid end                                 as frameid\n           , case when p1.type = '' then null else p1.type end                                       as type\n           , case when p1.qs_id = '' then null else p1.qs_id end                                     as qs_id\n           , case when p1.from_frameid = '' then null else p1.from_frameid end                       as from_frameid\n           , case when p1.from_object = '' then null else p1.from_object end                         as from_object\n           , case when p1.from_resourceid = '' then null else p1.from_resourceid end                 as from_resourceid\n           , case when p1.to_frameid = '' then null else p1.to_frameid end                           as to_frameid\n           , case when p1.to_resourceid = '' then null else p1.to_resourceid end                     as to_resourceid\n           , case when p1.to_scode = '' then null else p1.to_scode end                               as to_scode\n           , case when p1.account_id rlike '^(AL|TS)' then p1.account_id end                         as account_id\n           , case when p1.event_type = '' then null else p1.event_type end                           as event_type\n           , case when p1.target_id = '' then null else p1.target_id end                             as target_id\n           , case when p1.opentime rlike '^[0-9]+$' then substr(p1.opentime, 1, 10) end              as opentime\n           , 'YYZQZX'                                                                                as tenant_id\n           , p1.p_date\n      from (select case\n                       when log_str rlike '^user_id=' then regexp_extract(log_str, '^user_id=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|user_id=' then regexp_extract(log_str, '\\\\|user_id=([^\\\\|]*)', 1)\n          end           as user_id\n                 , case\n                       when log_str rlike '^guid=' then regexp_extract(log_str, '^guid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|guid=' then regexp_extract(log_str, '\\\\|guid=([^\\\\|]*)', 1)\n              end       as guid\n                 , case\n                       when log_str rlike '^application=' then regexp_extract(log_str, '^application=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|application=' then regexp_extract(log_str, '\\\\|application=([^\\\\|]*)', 1)\n              end       as `application`\n                 , case\n                       when log_str rlike '^version=' then regexp_extract(log_str, '^version=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|version=' then regexp_extract(log_str, '\\\\|version=([^\\\\|]*)', 1)\n              end       as version\n                 , case\n                       when log_str rlike '^platform=' then regexp_extract(log_str, '^platform=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|platform=' then regexp_extract(log_str, '\\\\|platform=([^\\\\|]*)', 1)\n              end       as platform\n                 , case\n                       when log_str rlike '^object=' then regexp_extract(log_str, '^object=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|object=' then regexp_extract(log_str, '\\\\|object=([^\\\\|]*)', 1)\n              end       as object\n                 , case\n                       when log_str rlike '^createtime=' then regexp_extract(log_str, '^createtime=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|createtime=' then regexp_extract(log_str, '\\\\|createtime=([^\\\\|]*)', 1)\n              end       as createtime\n                 , case\n                       when log_str rlike '^action_type=' then regexp_extract(log_str, '^action_type=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|action_type=' then regexp_extract(log_str, '\\\\|action_type=([^\\\\|]*)', 1)\n              end       as action_type\n                 , case\n                       when log_str rlike '^is_fanhui=' then regexp_extract(log_str, '^is_fanhui=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|is_fanhui=' then regexp_extract(log_str, '\\\\|is_fanhui=([^\\\\|]*)', 1)\n              end       as is_fanhui\n                 , case\n                       when log_str rlike '^scode_id=' then regexp_extract(log_str, '^scode_id=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|scode_id=' then regexp_extract(log_str, '\\\\|scode_id=([^\\\\|]*)', 1)\n              end       as scode_id\n                 , case\n                       when log_str rlike '^market_id=' then regexp_extract(log_str, '^market_id=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|market_id=' then regexp_extract(log_str, '\\\\|market_id=([^\\\\|]*)', 1)\n              end       as market_id\n                 , case\n                       when log_str rlike '^screen_direction='\n                           then regexp_extract(log_str, '^screen_direction=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|screen_direction='\n                           then regexp_extract(log_str, '\\\\|screen_direction=([^\\\\|]*)', 1)\n              end       as screen_direction\n                 , case\n                       when log_str rlike '^color=' then regexp_extract(log_str, '^color=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|color=' then regexp_extract(log_str, '\\\\|color=([^\\\\|]*)', 1)\n              end       as color\n                 , case\n                       when log_str rlike '^frameid=' then regexp_extract(log_str, '^frameid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|frameid=' then regexp_extract(log_str, '\\\\|frameid=([^\\\\|]*)', 1)\n              end       as frameid\n                 , case\n                       when log_str rlike '^type=' then regexp_extract(log_str, '^type=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|type=' then regexp_extract(log_str, '\\\\|type=([^\\\\|]*)', 1)\n              end       as type\n                 , case\n                       when log_str rlike '^qs_id=' then regexp_extract(log_str, '^qs_id=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|qs_id=' then regexp_extract(log_str, '\\\\|qs_id=([^\\\\|]*)', 1)\n              end       as qs_id\n                 , case\n                       when log_str rlike '^from_frameid=' then regexp_extract(log_str, '^from_frameid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|from_frameid='\n                           then regexp_extract(log_str, '\\\\|from_frameid=([^\\\\|]*)', 1)\n              end       as from_frameid\n                 , case\n                       when log_str rlike '^from_object=' then regexp_extract(log_str, '^from_object=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|from_object=' then regexp_extract(log_str, '\\\\|from_object=([^\\\\|]*)', 1)\n              end       as from_object\n                 , case\n                       when log_str rlike '^from_resourceid='\n                           then regexp_extract(log_str, '^from_resourceid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|from_resourceid='\n                           then regexp_extract(log_str, '\\\\|from_resourceid=([^\\\\|]*)', 1)\n              end       as from_resourceid\n                 , case\n                       when log_str rlike '^to_frameid=' then regexp_extract(log_str, '^to_frameid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|to_frameid=' then regexp_extract(log_str, '\\\\|to_frameid=([^\\\\|]*)', 1)\n              end       as to_frameid\n                 , case\n                       when log_str rlike '^to_resourceid=' then regexp_extract(log_str, '^to_resourceid=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|to_resourceid='\n                           then regexp_extract(log_str, '\\\\|to_resourceid=([^\\\\|]*)', 1)\n              end       as to_resourceid\n                 , case\n                       when log_str rlike '^to_scode=' then regexp_extract(log_str, '^to_scode=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|to_scode=' then regexp_extract(log_str, '\\\\|to_scode=([^\\\\|]*)', 1)\n              end       as to_scode\n                 , case\n                       when log_str rlike '^target_id=' then regexp_extract(log_str, '^target_id=([^\\\\|]*)', 1)\n                       when log_str rlike '\\\\|target_id=' then regexp_extract(log_str, '\\\\|target_id=([^\\\\|]*)', 1)\n              end       as target_id\n                 , null as account_id\n                 , null as event_type\n                 , null as opentime\n                 , case\n                       when log_str rlike '^user_id=' and\n                            cast(regexp_extract(log_str, '^user_id=([^\\\\|]*)', 1) as bigint) <= 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(regexp_extract(log_str, '^user_id=([^\\\\|]*)', 1),'0','A'),'1', 'C'),'2', 'E'), '3', 'G'),'4', 'I'), '5', 'K'), '6', 'M'), '7','O'), '8', 'Q'), '9', 'S')\n                       when log_str rlike '^user_id=' and\n                            cast(regexp_extract(log_str, '^user_id=([^\\\\|]*)', 1) as bigint) > 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(regexp_extract(log_str, '^user_id=([^\\\\|]*)', 1),'0','A'),'1', 'V'),'2', 'E'), '3', 'T'),'4', 'X'), '5', 'K'), '6', 'M'), '7','H'), '8', 'N'), '9', 'S')\n                       when log_str rlike '\\\\|user_id=' and\n                            cast(regexp_extract(log_str, '\\\\|user_id=([^\\\\|]*)', 1) as bigint) <= 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(regexp_extract(log_str, '\\\\|user_id=([^\\\\|]*)', 1),'0','A'),'1', 'C'),'2', 'E'), '3', 'G'),'4', 'I'), '5', 'K'), '6', 'M'), '7','O'), '8', 'Q'), '9', 'S')\n                       when log_str rlike '\\\\|user_id=' and\n                            cast(regexp_extract(log_str, '\\\\|user_id=([^\\\\|]*)', 1) as bigint) > 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(regexp_extract(log_str, '\\\\|user_id=([^\\\\|]*)', 1),'0','A'),'1', 'V'),'2', 'E'), '3', 'T'),'4', 'X'), '5', 'K'), '6', 'M'), '7','H'), '8', 'N'), '9', 'S')\n              end       as user_number\n                 , dt   as p_date\n            from ods.ods_app_behavior_di_0log\n            where (log_str rlike '^guid=' or log_str rlike '\\\\|guid=')\n              and dt = date_sub('2025-01-01', 1)\n            union all\n            select case\n                       when split(log_str, '\\\\|')[0] rlike '^([0-9]+)$'\n                           then split(log_str, '\\\\|')[0]\n                       when split(log_str, '\\\\|')[0] rlike '^(GZ|AZ)([A-Z0-9])+$'\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(regexp_extract(split(log_str, '\\\\|')[0],'^(GZ|AZ)(([A-Z0-9])+)$',2),'A','0'),'C','1'),'E','2'),'G','3'),'I','4'),'K','5'),'M','6'),'O','7'),'Q','8'),'S','9'),'V','1'),'T','3'),'X','4'),'H', '7'),'N', '8')\n                       else '0'\n                end                          as user_id\n                 , split(log_str, '\\\\|')[1]  as guid\n                 , split(log_str, '\\\\|')[2]  as `application`\n                 , split(log_str, '\\\\|')[3]  as version\n                 , split(log_str, '\\\\|')[4]  as platform\n                 , split(log_str, '\\\\|')[5]  as object\n                 , split(log_str, '\\\\|')[6]  as createtime\n                 , split(log_str, '\\\\|')[7]  as action_type\n                 , split(log_str, '\\\\|')[8]  as is_fanhui\n                 , split(log_str, '\\\\|')[9]  as scode_id\n                 , split(log_str, '\\\\|')[10] as market_id\n                 , split(log_str, '\\\\|')[11] as screen_direction\n                 , split(log_str, '\\\\|')[12] as color\n                 , split(log_str, '\\\\|')[13] as frameid\n                 , split(log_str, '\\\\|')[14] as type\n                 , split(log_str, '\\\\|')[15] as qs_id\n                 , split(log_str, '\\\\|')[16] as from_frameid\n                 , split(log_str, '\\\\|')[17] as from_object\n                 , split(log_str, '\\\\|')[18] as from_resourceid\n                 , split(log_str, '\\\\|')[19] as to_frameid\n                 , split(log_str, '\\\\|')[20] as to_resourceid\n                 , split(log_str, '\\\\|')[21] as to_scode\n                 , split(log_str, '\\\\|')[22] as target_id\n                 , split(log_str, '\\\\|')[23] as account_id\n                 , split(log_str, '\\\\|')[24] as event_type\n                 , split(log_str, '\\\\|')[25] as opentime\n                 , case\n                       when split(log_str, '\\\\|')[0] rlike '^(GZ|AZ)([A-Z0-9])+$'\n                           then regexp_extract(split(log_str, '\\\\|')[0], '^(GZ|AZ)(([A-Z0-9])+)$', 2)\n                       when split(log_str, '\\\\|')[0] rlike '^([0-9]+)$' and\n                            cast(split(log_str, '\\\\|')[0] as bigint) <= 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(split(log_str, '\\\\|')[0], '0', 'A'),'1','C'),'2','E'),'3','G'),'4','I'),'5','K'),'6','M'),'7','O'),'8', 'Q'), '9','S')\n                       when split(log_str, '\\\\|')[0] rlike '^([0-9]+)$' and\n                            cast(split(log_str, '\\\\|')[0] as bigint) > 523000\n                           then translate(translate(translate(translate(translate(translate(translate(translate(translate(translate(split(log_str, '\\\\|')[0], '0', 'A'),'1','V'),'2','E'),'3','T'),'4','X'),'5','K'),'6','M'),'7','H'),'8', 'N'), '9','S')\n                end                          as user_number\n                 , dt                        as p_date\n            from ods.ods_app_behavior_di_0log\n            where (split(log_str, '\\\\|')[0] rlike '^([0-9]+)$' or\n                   split(log_str, '\\\\|')[0] rlike '^(GZ|AZ)([A-Z0-9])+$' or log_str rlike '^\\\\|')\n              and dt = date_sub('2025-01-01', 1)\n           ) p1\n     ) p1;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}], taskRelationJson=[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160173109493344,"postTaskVersion":0,"conditionType":0,"conditionParams":null}], tenantCode=admin, description=股掌柜APP-行为数据 对应实时表cdm.dwd_gzg_log_app_behavior_rt
test, executionType=PARALLEL, globalParams=null, timeout=0)
2025-12-16 09:44:12.320 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160172825665120/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:55:19.818 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:55:19.824 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 09:55:19.831 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 09:55:22.856 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53007 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 09:55:22.857 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 09:55:23.228 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 09:55:23.247 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 2 JPA repository interfaces.
2025-12-16 09:55:23.605 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 09:55:23.609 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 09:55:23.609 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 09:55:23.626 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 09:55:23.626 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 752 ms
2025-12-16 09:55:23.737 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 09:55:23.764 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 09:55:23.777 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 09:55:23.869 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 09:55:23.880 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 09:55:23.984 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@2b80497f
2025-12-16 09:55:23.985 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 09:55:24.020 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 09:55:24.313 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 09:55:24.354 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:55:24.617 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 09:55:24.816 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 09:55:24.854 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 09:55:24.864 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.315 seconds (process running for 2.615)
2025-12-16 09:56:27.069 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-16 09:56:27.069 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-16 09:56:27.072 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-12-16 09:56:27.120 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 09:56:27.381 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160173862261344], success=true, failed=false)
2025-12-16 09:56:27.391 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160173862261344,"x":100,"y":100}],"taskDefinitionJson":[{"code":160173862261344,"version":0,"name":"dim_gzg_pub_ip_location_info","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160173862261344,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 09:56:27.477 INFO  c.x.s.d.workflow.WorkflowOperator - release workflow definition,url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition/160173862329952/release, param:WorkflowReleaseParam(name=null, releaseState=ONLINE)
2025-12-16 09:59:41.000 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:59:41.002 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 09:59:41.009 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 09:59:45.472 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53267 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 09:59:45.473 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 09:59:45.828 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 09:59:45.849 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 2 JPA repository interfaces.
2025-12-16 09:59:46.110 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 09:59:46.114 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 09:59:46.114 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 09:59:46.131 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 09:59:46.131 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 639 ms
2025-12-16 09:59:46.236 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 09:59:46.259 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 09:59:46.270 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 09:59:46.492 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 09:59:46.506 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 09:59:46.573 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4ff9f715
2025-12-16 09:59:46.574 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 09:59:46.610 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 09:59:46.897 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 09:59:46.930 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 09:59:47.180 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 09:59:47.371 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 09:59:47.399 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 09:59:47.409 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.176 seconds (process running for 2.408)
2025-12-16 10:00:00.190 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:00:00.207 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:00:15.032 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:00:15.040 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:00:20.574 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:00:20.576 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:00:20.580 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:03:14.702 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53494 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:03:14.703 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:03:15.075 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:03:15.096 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 2 JPA repository interfaces.
2025-12-16 10:03:15.363 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:03:15.367 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:03:15.367 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:03:15.384 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:03:15.384 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 664 ms
2025-12-16 10:03:15.488 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:03:15.511 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:03:15.522 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:03:15.597 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:03:15.608 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:03:15.678 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6294e4a6
2025-12-16 10:03:15.679 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:03:15.704 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:03:15.981 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:03:16.012 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:03:16.271 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:03:16.475 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:03:16.504 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:03:16.514 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.145 seconds (process running for 2.327)
2025-12-16 10:03:30.104 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:03:30.111 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:03:45.021 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:03:45.041 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:03:55.564 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:03:55.566 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:03:55.570 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:04:26.728 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53568 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:04:26.729 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:04:27.059 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:04:27.078 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 2 JPA repository interfaces.
2025-12-16 10:04:27.333 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:04:27.337 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:04:27.337 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:04:27.353 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:04:27.353 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 601 ms
2025-12-16 10:04:27.455 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:04:27.471 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:04:27.480 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:04:27.543 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:04:27.552 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:04:27.611 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@41ec4271
2025-12-16 10:04:27.611 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:04:27.633 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:04:27.926 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:04:27.954 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:04:28.209 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:04:28.438 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:04:28.469 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:04:28.478 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.07 seconds (process running for 2.225)
2025-12-16 10:04:30.206 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:04:30.214 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:04:45.032 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:04:45.047 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:04:48.665 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:04:48.667 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:04:48.671 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:06:11.102 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53702 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:06:11.103 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:06:11.438 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:06:11.459 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 2 JPA repository interfaces.
2025-12-16 10:06:11.717 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:06:11.721 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:06:11.721 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:06:11.739 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:06:11.739 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 620 ms
2025-12-16 10:06:11.849 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:06:11.871 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:06:11.882 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:06:11.959 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:06:11.969 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:06:12.025 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@13662609
2025-12-16 10:06:12.026 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:06:12.048 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:06:12.331 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:06:12.356 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:06:12.591 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:06:12.798 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:06:12.826 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:06:12.833 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 1.95 seconds (process running for 2.105)
2025-12-16 10:06:15.115 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:06:15.122 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:06:30.046 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:06:30.053 ERROR o.s.a.i.SimpleAsyncUncaughtExceptionHandler - Unexpected exception occurred invoking async method: public void com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending()
java.lang.ArrayIndexOutOfBoundsException: Index 0 out of bounds for length 0
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.buildReadyQueue(WorkflowQueueService.java:24)
	at com.xiaoxj.sqlworkflow.service.WorkflowQueueService.getTargetWorkflowName(WorkflowQueueService.java:46)
	at com.xiaoxj.sqlworkflow.scheduler.WorkflowOrchestrator.triggerPending(WorkflowOrchestrator.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:351)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:765)
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:113)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-16 10:06:32.097 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:06:32.099 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:06:32.103 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:07:24.659 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53816 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:07:24.661 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:07:24.977 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:07:24.998 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 2 JPA repository interfaces.
2025-12-16 10:07:25.250 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:07:25.254 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:07:25.254 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:07:25.272 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:07:25.272 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 594 ms
2025-12-16 10:07:25.427 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:07:25.443 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:07:25.453 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:07:25.533 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:07:25.542 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:07:25.596 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@71eff6a3
2025-12-16 10:07:25.596 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:07:25.617 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:07:25.888 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:07:25.909 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:07:26.156 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:07:26.359 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:07:26.388 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:07:26.398 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 1.967 seconds (process running for 2.114)
2025-12-16 10:07:30.061 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:07:30.120 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:07:45.020 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:07:45.039 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:08:00.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:08:00.051 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:08:15.020 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:08:15.043 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:08:30.013 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:08:30.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:08:45.011 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:08:45.031 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:09:00.049 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:09:00.070 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:09:15.021 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:09:15.041 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:09:30.048 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:09:30.063 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:09:45.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:09:45.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:09:54.243 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:09:54.249 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:09:54.257 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:09:56.795 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 53991 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:09:56.797 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:09:57.118 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:09:57.137 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 2 JPA repository interfaces.
2025-12-16 10:09:57.402 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:09:57.406 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:09:57.406 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:09:57.423 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:09:57.423 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 609 ms
2025-12-16 10:09:57.527 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:09:57.545 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:09:57.553 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:09:57.615 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:09:57.624 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:09:57.701 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@13662609
2025-12-16 10:09:57.703 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:09:57.740 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:09:58.131 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:09:58.155 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:09:58.534 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:09:58.827 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:09:58.861 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:09:58.872 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.387 seconds (process running for 2.534)
2025-12-16 10:10:00.080 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:10:00.114 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:10:15.018 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:10:15.033 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:10:30.016 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:10:30.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:10:45.012 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:10:45.028 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:11:00.058 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:11:00.081 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:11:15.028 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:11:15.042 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:11:23.541 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:11:23.543 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:11:23.548 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:11:26.193 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 54088 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:11:26.194 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:11:26.522 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:11:26.541 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 2 JPA repository interfaces.
2025-12-16 10:11:26.787 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:11:26.791 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:11:26.791 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:11:26.807 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:11:26.807 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 597 ms
2025-12-16 10:11:26.907 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:11:26.926 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:11:26.934 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:11:27.002 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:11:27.012 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:11:27.076 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@236a4d30
2025-12-16 10:11:27.077 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:11:27.099 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:11:27.374 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:11:27.398 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:11:27.643 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:11:27.834 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:11:27.860 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:11:27.870 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 1.957 seconds (process running for 2.099)
2025-12-16 10:11:30.090 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:11:30.120 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:11:45.022 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:11:45.047 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:12:00.010 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:12:00.036 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:12:15.031 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:12:15.043 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:12:30.011 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:12:30.032 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:12:45.027 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:12:45.045 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:12:51.273 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:12:51.276 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:12:51.283 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:13:00.492 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 54177 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:13:00.493 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:13:00.822 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:13:00.844 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 2 JPA repository interfaces.
2025-12-16 10:13:01.101 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:13:01.105 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:13:01.105 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:13:01.122 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:13:01.122 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 610 ms
2025-12-16 10:13:01.225 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:13:01.242 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:13:01.253 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:13:01.320 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:13:01.330 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:13:01.389 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7252bdb
2025-12-16 10:13:01.390 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:13:01.413 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:13:01.682 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:13:01.710 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:13:01.949 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:13:02.158 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:13:02.186 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:13:02.196 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 1.937 seconds (process running for 2.105)
2025-12-16 10:13:15.097 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:13:15.127 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:13:30.021 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:13:30.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:13:36.690 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-16 10:13:36.690 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-16 10:13:36.701 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 11 ms
2025-12-16 10:13:36.749 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/task-definition/gen-task-codes, param:1
2025-12-16 10:13:37.047 INFO  c.x.s.d.workflow.WorkflowOperator - generate task code response:HttpRestResult(code=0, msg=success, data=[160174916623968], success=true, failed=false)
2025-12-16 10:13:37.060 INFO  c.x.s.d.workflow.WorkflowOperator - create workflow definition, url:https://ds.gp51.com/dolphinscheduler/projects/159198460609120/workflow-definition, param:{"name":"dim_gzg_pub_ip_location_info","locations":[{"taskCode":160174916623968,"x":100,"y":100}],"taskDefinitionJson":[{"code":160174916623968,"version":0,"name":"dim_gzg_pub_ip_location_info","description":"","taskType":"HIVECLI","taskParams":{"dependence":{},"conditionResult":null,"waitStartTimeout":{},"switchResult":{},"hiveSqlScript":"--昨日全部ip\nwith all_ip as (\nselect\n    sip as ip\nfrom\n    (select ip as sip\n    from ods.ods_db_user_t_account_resigter_info_0db\n    where ip <> ''\n    and ip rlike '\\\\.'\n    and ip not rlike 'http'\n    and ip not rlike 'f29'\n    group by ip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pc_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_wmp_heartbeat_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_0log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_heartbeat_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_app_em_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_mb_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    union all\n    select sip\n    from ods.ods_pws_behavior_di_1log\n    where dt = date_sub(current_date(), 1)\n    and sip is not null\n    group by sip\n    )t\ngroup by \n    sip\n)\n\n--每日ip表临时表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info_temp\nselect\n    ip,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then province\n        else country\n    end as province,\n    case \n        when province in ('北京市','上海市','天津市','重庆市','香港','澳门','西藏自治区','内蒙古自治区',\n                '广西壮族自治区','宁夏回族自治区','新疆维吾尔自治区','湖北省','广东省','河南省','山东省','河北省',\n                '浙江省','辽宁省','四川省','安徽省','湖南省','陕西省','吉林省','福建省','山西省','云南省','江西省','贵州省',\n                '甘肃省','青海省','黑龙江省','江苏省','海南省','台湾省') then city\n        else null\n    end as city,\n    date_sub(current_date,1) as dt\nfrom\n    (select\n        ip,\n        case \n            -- 4个直辖市\n            when province like '%北京%' then '北京市'\n            when province like '%上海%' then '上海市'\n            when province like '%天津%' then '天津市'\n            when province like '%重庆%' then '重庆市'\n            -- 2个特别行政区\n            when province like '%香港%' then '香港'\n            when province like '%澳门%' then '澳门'\n            -- 5个自治区\n            when province like '%西藏%' then '西藏自治区'\n            when province like '%内蒙古%' then '内蒙古自治区'\n            when province like '%广西%' then '广西壮族自治区'\n            when province like '%宁夏%' then '宁夏回族自治区'\n            when province like '%新疆%' then '新疆维吾尔自治区'\n            -- 23个省\n            when province like '%湖北%' then '湖北省'\n            when province like '%广东%' then '广东省'\n            when province like '%河南%' then '河南省'\n            when province like '%山东%' then '山东省'\n            when province like '%河北%' then '河北省'\n            when province like '%浙江%' then '浙江省'\n            when province like '%辽宁%' then '辽宁省'\n            when province like '%四川%' then '四川省'\n            when province like '%安徽%' then '安徽省'\n            when province like '%湖南%' then '湖南省'\n            when province like '%陕西%' then '陕西省'\n            when province like '%吉林%' then '吉林省'\n            when province like '%福建%' then '福建省'\n            when province like '%山西%' then '山西省'\n            when province like '%云南%' then '云南省'\n            when province like '%江西%' then '江西省'\n            when province like '%贵州%' then '贵州省'\n            when province like '%甘肃%' then '甘肃省'\n            when province like '%青海%' then '青海省'\n            when province like '%黑龙江%' then '黑龙江省'\n            when province like '%江苏%' then '江苏省'\n            when province like '%海南%' then '海南省'\n            when province like '%台湾%' then '台湾省'\n        else province\n        end as province,\n        case \n            -- 一些需要特殊处理的市\n            when city like '%北京%'    then null\n            when city like '%上海%'    then null\n            when city like '%天津%'    then null\n            when city like '%重庆%'    then null\n            when city like '%香港%'    then null\n            when city like '%澳门%'    then null\n            when city like '%那曲%'    then '那曲市'\n            when city like '%山南%'    then '山南市'\n            when city like '%林芝%'    then '林芝市'\n            when city like '%日喀则%'  then '日喀则市'\n            when city like '%阿里地区%' then '阿里市'\n            when city like '%昌都%'     then '昌都市'\n            when city like '%桂林%'     then '桂林市'\n            when city like '%哈密%'     then '哈密市'\n            when city like '%阿勒泰%'   then '阿勒泰市'\n            when city like '%塔城%'    then '塔城市'\n            when city like '%喀什%'   then '喀什市'\n            when city like '%阿克苏%'  then '阿克苏市'\n            when city like '%和田%'   then '和田市'\n            when city like '%吐鲁番%'  then '吐鲁番市'\n            when city like '%恩施%'   then '恩施市'\n            when city like '%襄阳%'  then '襄阳市'\n            when city like '%汕头%'  then '汕头市'\n            when city like '%济源%'  then '济源市'\n            when city like '%郑州%'  then '郑州市'\n            when city like '%廊坊%'  then '廊坊市'\n            when city like '%朝阳%'  then '朝阳市'\n            when city like '%盘锦%'  then '盘锦市'\n            when city like '%本溪%'  then '本溪市'\n            when city like '%大连%'  then '大连市'\n            when city like '%沈阳%'  then '沈阳市'\n            when city like '%阿坝%'  then '阿坝州'\n            when city like '%蚌埠%'  then '蚌埠市'\n            when city like '%延边%'  then '延边市'\n            when city like '%临汾%'  then '临汾市'\n            when city like '%毕节%'  then '毕节市'\n            when city like '%铜仁%'  then '铜仁市'\n            when city like '%临夏%'  then '临夏市'\n            when city like '%海东%'  then '海东市'\n            when city like '%西宁%'  then '西宁市'\n            when city like '%大兴安岭%'  then '大兴安岭市'\n            when city like '%淮安%'  then '淮安市'\n            when city like '%苏州%'  then '苏州市'\n            when city like '%儋州%'  then '儋州市'\n            when city like '%新北%'  then '新北市'\n            when city like '%台中%'  then '台中市'\n            when city like '%高雄%'  then '高雄市'\n            when city like '%台南%'  then '台南市'\n            when city like '%桃园%'  then '桃园市'\n            when city like '%台北%'  then '台北市'\n            when city like '%南阳%'  then '南阳市'\n            when city = '0' then null\n        else city\n        end as city,\n        country\n    from\n        (select \n            ip,\n            get_json_object(default.get_address(ip), '$.country') as country,\n            get_json_object(default.get_address(ip), '$.province') as province,\n            get_json_object(default.get_address(ip), '$.city') as city\n        from \n            all_ip \n        )t1\n    )t2\nwhere \n    province != '0' and province is not null\n;\n\n--合并全量表\ninsert overwrite table cdm.dim_gzg_pub_ip_location_info\nselect\n    ip,\n    province,\n    city,\n    dt\nfrom \n    cdm.dim_gzg_pub_ip_location_info_temp\nunion all\nselect\n    t1.ip,\n    t1.province,\n    t1.city,\n    cast(date_sub(current_date,1) as string) as dt\nfrom\n    cdm.dim_gzg_pub_ip_location_info t1\nleft join\n    cdm.dim_gzg_pub_ip_location_info_temp t2\non \n    (t1.ip = t2.ip)\nwhere \n    t2.ip is null\n;","hiveCliTaskExecutionType":"SCRIPT","hiveCliOptions":null,"resourceList":[],"localParams":[],"taskType":"HIVECLI"},"flag":"YES","taskPriority":"MEDIUM","workerGroup":"default","failRetryTimes":"3","failRetryInterval":"1","timeoutFlag":"CLOSE","timeoutNotifyStrategy":"WARN","timeout":0,"delayTime":"0","environmentCode":-1,"taskExecuteType":null,"cpuQuota":-1,"memoryMax":-1,"isCache":"NO"}],"taskRelationJson":[{"name":"","preTaskCode":0,"preTaskVersion":0,"postTaskCode":160174916623968,"postTaskVersion":0,"conditionType":0,"conditionParams":null}],"tenantCode":"admin","description":"昨日全部ip","executionType":"PARALLEL","globalParams":null,"timeout":"0"}
2025-12-16 10:13:37.111 ERROR c.x.s.d.workflow.WorkflowOperator - dolphin scheduler response:HttpRestResult(code=10168, msg=workflow definition name dim_gzg_pub_ip_location_info already exists, data=null, success=false, failed=true)
2025-12-16 10:13:37.112 ERROR c.x.s.e.GlobalExceptionHandler - Unhandled exception
com.xiaoxj.sqlworkflow.core.DolphinException: create dolphin scheduler workflow fail
	at com.xiaoxj.sqlworkflow.dolphinscheduler.workflow.WorkflowOperator.create(WorkflowOperator.java:85)
	at com.xiaoxj.sqlworkflow.service.DolphinSchedulerService.createWorkflow(DolphinSchedulerService.java:52)
	at com.xiaoxj.sqlworkflow.controller.DependencyController.addWorkflow(DependencyController.java:52)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:925)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:830)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:896)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1744)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: com.xiaoxj.sqlworkflow.core.DolphinException: create dolphin scheduler workflow fail
	at com.xiaoxj.sqlworkflow.dolphinscheduler.workflow.WorkflowOperator.create(WorkflowOperator.java:82)
	... 54 common frames omitted
2025-12-16 10:13:45.021 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:13:45.044 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:14:00.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:14:00.026 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:14:15.061 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:14:15.118 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:14:30.011 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:14:30.034 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:14:45.041 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:14:45.063 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:15:00.031 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:15:00.092 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:15:01.813 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:15:01.815 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:15:01.821 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:15:04.256 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 54472 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:15:04.257 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:15:04.776 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:15:04.814 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 34 ms. Found 2 JPA repository interfaces.
2025-12-16 10:15:05.111 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:15:05.116 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:15:05.116 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:15:05.136 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:15:05.136 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 862 ms
2025-12-16 10:15:05.255 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:15:05.279 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:15:05.290 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:15:05.374 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:15:05.384 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:15:05.442 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@1a02ebe0
2025-12-16 10:15:05.442 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:15:05.464 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:15:05.744 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:15:05.766 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:15:06.021 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:15:06.220 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:15:06.250 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:15:06.260 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.23 seconds (process running for 2.404)
2025-12-16 10:15:15.099 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:15:15.229 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:15:30.017 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:15:30.140 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:15:45.019 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:15:45.107 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:16:00.023 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:16:00.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:16:15.021 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:16:15.107 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:16:30.045 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:16:30.127 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:16:45.005 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:16:45.088 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:17:00.037 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:17:00.132 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:17:03.866 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:17:03.869 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:17:03.882 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:17:23.313 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 54621 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:17:23.314 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:17:23.656 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:17:23.676 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 2 JPA repository interfaces.
2025-12-16 10:17:23.940 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:17:23.943 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:17:23.943 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:17:23.960 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:17:23.960 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 624 ms
2025-12-16 10:17:24.059 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:17:24.076 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:17:24.085 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:17:24.149 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:17:24.160 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:17:24.226 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7507d96c
2025-12-16 10:17:24.227 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:17:24.252 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:17:24.541 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:17:24.562 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:17:24.804 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:17:25.014 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:17:25.042 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:17:25.052 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.009 seconds (process running for 2.239)
2025-12-16 10:17:30.092 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:17:30.219 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:17:45.014 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:17:45.127 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:18:00.017 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:18:00.098 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:18:15.027 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:18:15.120 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:18:30.028 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:18:30.122 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:18:45.025 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:18:45.114 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:19:00.048 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:19:00.146 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:19:15.019 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:19:15.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:19:16.898 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:19:16.900 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:19:16.904 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-16 10:19:18.875 INFO  c.x.s.SqlWorkflowApplication - Starting SqlWorkflowApplication using Java 21.0.6 with PID 54732 (/Users/xiaojunxiao/codes/xiaoxj/sql-workflow/target/classes started by xiaojunxiao in /Users/xiaojunxiao/codes/xiaoxj/sql-workflow)
2025-12-16 10:19:18.876 INFO  c.x.s.SqlWorkflowApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-16 10:19:19.191 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-16 10:19:19.213 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 2 JPA repository interfaces.
2025-12-16 10:19:19.499 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 9000 (http)
2025-12-16 10:19:19.503 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-16 10:19:19.503 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.19]
2025-12-16 10:19:19.519 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-16 10:19:19.520 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 628 ms
2025-12-16 10:19:19.624 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-16 10:19:19.640 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.4.4.Final
2025-12-16 10:19:19.649 INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-16 10:19:19.715 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-16 10:19:19.725 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-16 10:19:19.783 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@620572db
2025-12-16 10:19:19.784 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-16 10:19:19.806 WARN  org.hibernate.orm.deprecation - HHH90000025: MySQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-16 10:19:20.129 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-16 10:19:20.147 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:19:20.413 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-16 10:19:20.670 INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoint(s) beneath base path '/actuator'
2025-12-16 10:19:20.700 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 9000 (http) with context path ''
2025-12-16 10:19:20.710 INFO  c.x.s.SqlWorkflowApplication - Started SqlWorkflowApplication in 2.066 seconds (process running for 2.209)
2025-12-16 10:19:30.099 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:19:30.238 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:19:45.013 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:19:45.119 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:20:00.009 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:20:00.192 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:20:15.033 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:20:15.128 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:20:30.016 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:20:30.112 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:20:45.026 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:20:45.116 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:21:00.027 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:21:00.119 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:21:15.038 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:21:15.130 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:21:30.012 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:21:30.104 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:21:45.003 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:21:45.098 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:22:00.000 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:22:00.093 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:22:15.024 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:22:15.117 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:22:30.009 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:22:30.101 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:22:45.014 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:22:45.119 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:23:00.012 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:23:00.106 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:23:15.009 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:23:15.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:23:30.025 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:23:30.117 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:23:45.005 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:23:45.093 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:24:00.010 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:24:00.127 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:24:15.016 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:24:15.111 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:24:30.011 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:24:30.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:24:45.008 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:24:45.115 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:25:00.047 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:25:00.129 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:25:15.016 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:25:15.110 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:25:30.008 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:25:30.096 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:25:45.022 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:25:45.107 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:26:00.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:26:00.106 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:26:15.028 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:26:15.131 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:26:30.061 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:26:30.145 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:26:45.026 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:26:45.124 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:27:00.007 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:27:00.099 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:27:15.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:27:15.113 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:27:30.009 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:27:30.108 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:27:45.041 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:27:45.135 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:28:00.010 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:28:00.099 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:28:15.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:28:15.107 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:28:30.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:28:30.223 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:28:45.025 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:28:45.110 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:29:00.006 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:29:00.111 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:29:15.006 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:29:15.098 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:29:30.022 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:29:30.108 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:29:45.010 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:29:45.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:30:00.012 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:30:00.106 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:30:15.012 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:30:15.105 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:30:30.015 INFO  c.x.s.scheduler.WorkflowOrchestrator - No running workflow found.
2025-12-16 10:30:30.103 INFO  c.x.s.scheduler.WorkflowOrchestrator - No pending workflow found.
2025-12-16 10:30:33.883 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-16 10:30:33.885 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-16 10:30:33.892 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
